-- Initialize Rayfield UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Ikorz Hub",
   Icon = 0, 
   LoadingTitle = "Rayfield Interface Suite",
   LoadingSubtitle = "by Ikorz",
   Theme = "Default",

   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "Ikorz_Hub"
   },

   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },

   KeySystem = false,
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided",
      FileName = "Key",
      SaveKey = true,
      GrabKeyFromSite = false,
      Key = {"Hello"}
   }
})

-- Aimbot settings
getgenv().aimbot_enabled = true
getgenv().aimbot_smoothness = 0 -- You can adjust smoothness if needed (0 for instant)
getgenv().noclip_enabled = false

local user_input_service = game:GetService("UserInputService")
local players_service = game:GetService("Players")
local run_service = game:GetService("RunService")

local function getClosestPlayer()
   local closest_player = nil
   local closest_distance = math.huge
   local local_player = players_service.LocalPlayer
   local camera = workspace.CurrentCamera

   for _, player in ipairs(players_service:GetPlayers()) do
       if player == local_player then continue end
       if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then continue end

       local target = player.Character:FindFirstChild("HumanoidRootPart")
       if target then
           local position, on_screen = camera:WorldToViewportPoint(target.Position)
           if on_screen then
               local center = Vector2.new(camera.ViewportSize.X / 2, camera.ViewportSize.Y / 2)
               local distance = (center - Vector2.new(position.X, position.Y)).Magnitude
               if distance < closest_distance then
                   closest_player = player
                   closest_distance = distance
               end
           end
       end
   end

   return closest_player
end

local function aimAtPlayer(player)
   if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
       local aim_part = player.Character["HumanoidRootPart"]
       local camera = workspace.CurrentCamera
       local aim_position = aim_part.Position
       local camera_position = camera.CFrame.Position
       local direction = (aim_position - camera_position).unit

       -- Adjusts CFrame to aim at target smoothly if enabled
       if getgenv().aimbot_smoothness > 0 then
           local new_cframe = camera.CFrame:Lerp(CFrame.new(camera_position, aim_position), getgenv().aimbot_smoothness)
           camera.CFrame = new_cframe
       else
           camera.CFrame = CFrame.new(camera_position, aim_position)
       end
   end
end

user_input_service.InputBegan:Connect(function(input)
   if input.UserInputType == Enum.UserInputType.MouseButton2 then
       getgenv().aimbot_enabled = not getgenv().aimbot_enabled
   end
end)

run_service.RenderStepped:Connect(function()
   if getgenv().aimbot_enabled then
       local closest_player = getClosestPlayer()
       if closest_player then
           aimAtPlayer(closest_player)
       end
   end
end)

-- Load the configuration
Rayfield:LoadConfiguration()